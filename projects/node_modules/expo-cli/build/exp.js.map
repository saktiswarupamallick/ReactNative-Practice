{"version":3,"file":"exp.js","names":["_bunyan","data","_interopRequireDefault","require","_config","_boxen","_chalk","_commander","_interopRequireWildcard","_fs","_getenv","_leven","_findLastIndex","_path","_progress","_stripAnsi","_url","_wrapAnsi","_xdl","_StatusEventEmitter","_commands","_accounts","_TerminalLink","_profileMethod","_urlOpts","_log","_handleErrors","_matchFileNameOrURLFromStackTrace","_ora","obj","__esModule","default","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","packageJSON","ApiV2","setClientName","version","Command","urlOpts","addOptions","allowOffline","option","helpGroup","name","commands","length","__helpGroup","parent","longDescription","__longDescription","pad","str","width","len","Math","max","stripAnsi","Array","join","humanReadableArgName","arg","nameOutput","variadic","required","breakSentence","input","wrapAnsi","prepareCommands","filter","cmd","getenv","boolish","includes","map","i","_cmd$__helpGroup","args","_args","description","_description","nameWithAlias","_name","usage","commandsStr","argsStr","arguments","_usage","helpInformation","_this$__longDescripti","replaceAll","argsDescription","_argsDescription","padWidth","push","forEach","cmdName","_alias","chalk","bold","dim","commandHelp","options","optionHelp","replace","string","search","split","helpGroupOrder","exports","sortHelpGroups","helpGroups","groupOrder","Set","keys","subGroupOrder","core","sortSubGroupWithOrder","groupName","group","order","sortedCommands","shift","index","findIndex","item","startsWith","splice","concat","sortedGroups","reduce","prev","curr","command","sorted","values","noArgsCmd","noArgsCmdArgs","wrappedDescription","paddedName","program","on","Log","log","asyncAction","asyncFn","action","nonInteractive","profileMethod","checkCliVersionAsync","offline","ConnectionStatus","Promise","resolve","then","setIsOffline","all","Analytics","flush","UnifiedAnalytics","err","commandName","handleErrorsAsync","process","exit","asyncActionProjectDir","yellow","projectRoot","opts","cwd","path","config","learnMore","newLine","addNewLineIfNone","green","cyan","pathToConfig","fs","existsSync","relativeInput","relative","formattedPath","reset","nestedWarn","helpCommand","setCustomConfigPath","logLines","msg","logFn","line","INTERNAL_CALLSITES_REGEX","logStackTrace","chunk","nestedLogFn","traceInfo","JSON","parse","message","stack","isLibraryFrame","stackFrames","lastAppCodeFrameIndex","findLastIndex","lastFrameIndexToLog","min","unloggedFrames","isCollapsed","fileNameOrUrl","matchFileNameOrURLFromStackTrace","test","isDebug","style","printNewLineBeforeNextLog","logWithLevel","level","bunyan","INFO","includesStack","nested","WARN","warn","error","nestedError","bar","PackagerLogsStream","onStartBuildBundle","bundleDetails","platform","getPlatformTagForBuildDetails","ProgressBar","total","clear","complete","incomplete","setBundleProgressBar","onProgressBuildBundle","progress","ticks","tick","onFinishBuildBundle","start","end","terminate","totalBuildTimeMs","getTime","durationSuffix","gray","red","StatusEventEmitter","emit","updateLogs","updater","newLogChunks","newLogChunk","issueId","issueCleared","ProjectUtils","attachLoggerStream","stream","write","tag","deviceId","deviceName","type","checkConfig","ProjectSettings","getCurrentStatusAsync","spinner","ora","setSpinner","Doctor","status","validateWithoutNetworkAsync","skipSDKVersionRequirement","FATAL","Error","stop","bootstrapAnalyticsAsync","initializeClient","userData","UserManager","getCachedUserDataAsync","userId","identifyUser","currentConnection","username","trackUsage","_commands$find","argv","ExpoCommand","undefined","subCommand","find","logEvent","source","source_version","runAsync","programName","_registerLogs","Env","shouldEnableAnalytics","setInteractiveAuthenticationCallback","loginOrRegisterAsync","env","SERVER_URL","serverUrl","parsedUrl","url","port","parseInt","hostname","Config","api","host","registerCommands","availableCommands","suggestion","leven","stdin","isTTY","help","e","boxen","borderColor","padding","code","LoadingEvent","START_PROGRESS_BAR","TICK_PROGRESS_BAR","getProgress","STOP_PROGRESS_BAR","START_LOADING","logNewSection","STOP_LOADING","getSpinner","DEBUG","debug","ERROR","Logger","notifications","addStream","global","writePathAsync","Binaries","writePathToUserSettingsAsync","run","catch"],"sources":["../src/exp.ts"],"sourcesContent":["import bunyan from '@expo/bunyan';\nimport { setCustomConfigPath } from '@expo/config';\nimport boxen from 'boxen';\nimport chalk from 'chalk';\nimport program, { Command } from 'commander';\nimport fs from 'fs';\nimport getenv from 'getenv';\nimport leven from 'leven';\nimport findLastIndex from 'lodash/findLastIndex';\nimport path from 'path';\nimport ProgressBar from 'progress';\nimport stripAnsi from 'strip-ansi';\nimport url from 'url';\nimport wrapAnsi from 'wrap-ansi';\nimport {\n  Analytics,\n  ApiV2,\n  Binaries,\n  Config,\n  Env,\n  LoadingEvent,\n  Logger,\n  LogRecord,\n  LogUpdater,\n  PackagerLogsStream,\n  ProjectSettings,\n  ProjectUtils,\n  UnifiedAnalytics,\n  UserManager,\n} from 'xdl';\n\nimport StatusEventEmitter from './analytics/StatusEventEmitter';\nimport { registerCommands } from './commands';\nimport { loginOrRegisterAsync } from './commands/auth/accounts';\nimport { learnMore } from './commands/utils/TerminalLink';\nimport { profileMethod } from './commands/utils/profileMethod';\nimport urlOpts from './commands/utils/urlOpts';\nimport Log from './log';\nimport { handleErrorsAsync } from './utils/handleErrors';\nimport { matchFileNameOrURLFromStackTrace } from './utils/matchFileNameOrURLFromStackTrace';\nimport { logNewSection, ora } from './utils/ora';\nimport update from './utils/update';\n\n// We use require() to exclude package.json from TypeScript's analysis since it lives outside the\n// src directory and would change the directory structure of the emitted files under the build\n// directory\nconst packageJSON = require('../package.json');\n\nApiV2.setClientName(packageJSON.version);\n\n// The following prototyped functions are not used here, but within in each file found in `./commands`\n// Extending commander to easily add more options to certain command line arguments\nCommand.prototype.urlOpts = function () {\n  urlOpts.addOptions(this);\n  return this;\n};\n\nCommand.prototype.allowOffline = function () {\n  this.option('--offline', 'Allows this command to run while offline');\n  return this;\n};\n\n// Add support for logical command groupings\nCommand.prototype.helpGroup = function (name: string) {\n  if (this.commands[this.commands.length - 1]) {\n    this.commands[this.commands.length - 1].__helpGroup = name;\n  } else {\n    this.parent.helpGroup(name);\n  }\n  return this;\n};\n\n// A longer description that will be displayed then the command is used with --help\nCommand.prototype.longDescription = function (name: string) {\n  if (this.commands[this.commands.length - 1]) {\n    this.commands[this.commands.length - 1].__longDescription = name;\n  } else {\n    this.parent.longDescription(name);\n  }\n  return this;\n};\n\nfunction pad(str: string, width: number): string {\n  // Pulled from commander for overriding\n  const len = Math.max(0, width - stripAnsi(str).length);\n  return str + Array(len + 1).join(' ');\n}\n\nfunction humanReadableArgName(arg: any): string {\n  // Pulled from commander for overriding\n  const nameOutput = arg.name + (arg.variadic === true ? '...' : '');\n  return arg.required ? `<${nameOutput}>` : `[${nameOutput}]`;\n}\n\nfunction breakSentence(input: string): string {\n  // Break a sentence by the word after a max character count, adjusting for ansi characters\n  return wrapAnsi(input, 72);\n}\n\nCommand.prototype.prepareCommands = function () {\n  return this.commands\n    .filter(function (cmd: Command) {\n      // Display all commands with EXPO_DEBUG, otherwise use the noHelp option.\n      if (getenv.boolish('EXPO_DEBUG', false)) {\n        return true;\n      }\n      return !['internal'].includes(cmd.__helpGroup);\n    })\n    .map(function (cmd: Command, i: number) {\n      const args = cmd._args.map(humanReadableArgName).join(' ');\n\n      const description = cmd._description;\n      // Remove alias. We still show this with --help on the command.\n      // const alias = cmd._alias;\n      // const nameWithAlias = cmd._name + (alias ? '|' + alias : '');\n      const nameWithAlias = cmd._name;\n      return [\n        nameWithAlias +\n          // Remove the redundant [options] string that's shown after every command.\n          // (cmd.options.length ? ' [options]' : '') +\n          (args ? ' ' + args : ''),\n        breakSentence(description),\n        cmd.__helpGroup ?? 'misc',\n      ];\n    });\n};\n\n/**\n * Set / get the command usage `str`.\n *\n * @param {String} str\n * @return {String|Command}\n * @api public\n */\n\n// @ts-ignore\nCommand.prototype.usage = function (str: string) {\n  const args = this._args.map(function (arg: any[]) {\n    return humanReadableArgName(arg);\n  });\n\n  const commandsStr = this.commands.length ? '[command]' : '';\n  const argsStr = this._args.length ? args.join(' ') : '';\n\n  let usage = commandsStr + argsStr;\n  if (usage.length) usage += ' ';\n  usage += '[options]';\n\n  if (arguments.length === 0) {\n    return this._usage || usage;\n  }\n  this._usage = str;\n\n  return this;\n};\n\nCommand.prototype.helpInformation = function () {\n  let desc: string[] = [];\n  // Use the long description if available, otherwise use the regular description.\n  const description = this.__longDescription ?? this._description;\n  if (description) {\n    desc = [replaceAll(breakSentence(description), '\\n', pad('\\n', 3)), ''];\n\n    const argsDescription = this._argsDescription;\n    if (argsDescription && this._args.length) {\n      const width = this.padWidth();\n      desc.push('Arguments:');\n      desc.push('');\n      this._args.forEach(({ name }: { name: string }) => {\n        desc.push('  ' + pad(name, width) + '  ' + argsDescription[name]);\n      });\n      desc.push('');\n    }\n  }\n\n  let cmdName = this._name;\n  if (this._alias) {\n    // Here is the only place we show the command alias\n    cmdName = `${cmdName}|${this._alias}`;\n  }\n\n  // Dim the options to keep things consistent.\n  const usage = `${chalk.bold`Usage:`} ${cmdName} ${chalk.dim(this.usage())}\\n`;\n\n  const commandHelp = '' + this.commandHelp();\n\n  const options = [chalk.bold`Options:`, '\\n' + this.optionHelp().replace(/^/gm, '    '), ''];\n\n  // return ['', usage, ...desc, ...options, commandHelp].join('\\n') + '\\n';\n  return ['', usage, ...desc, ...options, commandHelp].join(pad('\\n', 3)) + '\\n';\n};\n\nfunction replaceAll(string: string, search: string, replace: string): string {\n  return string.split(search).join(replace);\n}\n\nexport const helpGroupOrder = [\n  'core',\n  'auth',\n  'client',\n  'info',\n  'eject',\n  'publish',\n  'build',\n  'credentials',\n  'notifications',\n  'url',\n  'webhooks',\n  'upload',\n  'internal',\n  'deprecated',\n];\n\nfunction sortHelpGroups(helpGroups: Record<string, string[][]>): Record<string, string[][]> {\n  const groupOrder = [\n    ...new Set([\n      ...helpGroupOrder,\n      // add any others and remove duplicates\n      ...Object.keys(helpGroups),\n    ]),\n  ];\n\n  const subGroupOrder: Record<string, string[]> = {\n    core: ['init', 'start', 'start:web', 'publish', 'export'],\n  };\n\n  const sortSubGroupWithOrder = (groupName: string, group: string[][]): string[][] => {\n    const order: string[] = subGroupOrder[groupName];\n    if (!order?.length) {\n      return group;\n    }\n\n    const sortedCommands: string[][] = [];\n\n    while (order.length) {\n      const key = order.shift()!;\n      const index = group.findIndex(item => item[0].startsWith(key));\n      if (index >= 0) {\n        const [item] = group.splice(index, 1);\n        sortedCommands.push(item);\n      }\n    }\n\n    return sortedCommands.concat(group);\n  };\n\n  // Reverse the groups\n  const sortedGroups: Record<string, string[][]> = {};\n  while (groupOrder.length) {\n    const group = groupOrder.shift()!;\n    if (group in helpGroups) {\n      sortedGroups[group] = helpGroups[group];\n    }\n  }\n\n  return Object.keys(sortedGroups).reduce(\n    (prev, curr) => ({\n      ...prev,\n      // Sort subgroups that have a defined order\n      [curr]: sortSubGroupWithOrder(curr, helpGroups[curr]),\n    }),\n    {}\n  );\n}\n\n// Extended the help renderer to add a custom format and groupings.\nCommand.prototype.commandHelp = function () {\n  if (!this.commands.length) {\n    return '';\n  }\n  const width: number = this.padWidth();\n  const commands: string[][] = this.prepareCommands();\n\n  const helpGroups: Record<string, string[][]> = {};\n\n  // Sort commands into helpGroups\n  for (const command of commands) {\n    const groupName = command[2];\n    if (!helpGroups[groupName]) {\n      helpGroups[groupName] = [];\n    }\n    helpGroups[groupName].push(command);\n  }\n\n  const sorted = sortHelpGroups(helpGroups);\n\n  // Render everything.\n  return [\n    '' + chalk.bold('Commands:'),\n    '',\n    // Render all of the groups.\n    Object.values(sorted)\n      .map(group =>\n        group\n          // Render the command and description\n          .map(([cmd, description]: string[]) => {\n            // Dim the arguments that come after the command, this makes scanning a bit easier.\n            let [noArgsCmd, ...noArgsCmdArgs] = cmd.split(' ');\n            if (noArgsCmdArgs.length) {\n              noArgsCmd += ` ${chalk.dim(noArgsCmdArgs.join(' '))}`;\n            }\n\n            // Word wrap the description.\n            let wrappedDescription = description;\n            if (description) {\n              // Ensure the wrapped description appears on the same padded line.\n              wrappedDescription = '  ' + replaceAll(description, '\\n', pad('\\n', width + 3));\n            }\n\n            const paddedName = wrappedDescription ? pad(noArgsCmd, width) : noArgsCmd;\n            return paddedName + wrappedDescription;\n          })\n          .join('\\n')\n          .replace(/^/gm, '    ')\n      )\n      // Double new line to add spacing between groups\n      .join('\\n\\n'),\n    '',\n  ].join('\\n');\n};\n\nprogram.on('--help', () => {\n  Log.log(`  Run a command with --help for more info ðŸ’¡`);\n  Log.log(`    $ expo start --help`);\n  Log.log();\n});\n\nexport type Action = (...args: any[]) => void;\n\n// asyncAction is a wrapper for all commands/actions to be executed after commander is done\n// parsing the command input\nCommand.prototype.asyncAction = function (asyncFn: Action) {\n  return this.action(async (...args: any[]) => {\n    if (!getenv.boolish('EAS_BUILD', false) && !program.nonInteractive) {\n      try {\n        await profileMethod(checkCliVersionAsync)();\n      } catch {}\n    }\n\n    try {\n      const options = args[args.length - 1];\n      if (options.offline) {\n        const { ConnectionStatus } = await import('xdl');\n        ConnectionStatus.setIsOffline(true);\n      }\n\n      await asyncFn(...args);\n      // After a command, flush the analytics queue so the program will not have any active timers\n      // This allows node js to exit immediately\n      await Promise.all([Analytics.flush(), UnifiedAnalytics.flush()]);\n    } catch (err: any) {\n      // If the `--name` property is being used then we can be sure that the error is coming from `expo init`.\n      const commandName = typeof this.name === 'string' ? 'init (probably)' : this.name();\n      await handleErrorsAsync(err, { command: commandName });\n      process.exit(1);\n    }\n  });\n};\n\n// asyncActionProjectDir captures the projectDirectory from the command line,\n// setting it to cwd if it is not provided.\n// Commands such as `start` and `publish` use this.\n// It does several things:\n// - Everything in asyncAction\n// - Checks if the user is logged in or out\n// - Checks for updates\n// - Attaches the bundling logger\n// - Checks if the project directory is valid or not\n// - Runs AsyncAction with the projectDir as an argument\nCommand.prototype.asyncActionProjectDir = function (\n  asyncFn: Action,\n  options: { checkConfig?: boolean; skipSDKVersionRequirement?: boolean } = {}\n) {\n  this.option(\n    '--config [file]',\n    `${chalk.yellow('Deprecated:')} Use app.config.js to switch config files instead.`\n  );\n  return this.asyncAction(async (projectRoot: string, ...args: any[]) => {\n    const opts = args[0];\n\n    if (!projectRoot) {\n      projectRoot = process.cwd();\n    } else {\n      projectRoot = path.resolve(process.cwd(), projectRoot);\n    }\n\n    if (opts.config) {\n      Log.log(\n        chalk.yellow(\n          `\\u203A ${chalk.bold(\n            '--config'\n          )} flag is deprecated. Use app.config.js instead. ${learnMore(\n            'https://expo.fyi/config-flag-migration'\n          )}`\n        )\n      );\n      Log.newLine();\n\n      // @ts-ignore: This guards against someone passing --config without a path.\n      if (opts.config === true) {\n        Log.addNewLineIfNone();\n        Log.log('Please specify your custom config path:');\n        Log.log(chalk.green(`  expo ${this.name()} --config ${chalk.cyan(`<app-config>`)}`));\n        Log.newLine();\n        process.exit(1);\n      }\n\n      const pathToConfig = path.resolve(process.cwd(), opts.config);\n      // Warn the user when the custom config path they provided does not exist.\n      if (!fs.existsSync(pathToConfig)) {\n        const relativeInput = path.relative(process.cwd(), opts.config);\n        const formattedPath = chalk\n          .reset(pathToConfig)\n          .replace(relativeInput, chalk.bold(relativeInput));\n        Log.addNewLineIfNone();\n        Log.nestedWarn(`Custom config file does not exist:\\n${formattedPath}`);\n        Log.newLine();\n        const helpCommand = chalk.green(`expo ${this.name()} --help`);\n        Log.log(`Run ${helpCommand} for more info`);\n        Log.newLine();\n        process.exit(1);\n        // throw new Error(`File at provided config path does not exist: ${pathToConfig}`);\n      }\n      setCustomConfigPath(projectRoot, pathToConfig);\n    }\n\n    const logLines = (msg: any, logFn: (...args: any[]) => void) => {\n      if (typeof msg === 'string') {\n        for (const line of msg.split('\\n')) {\n          logFn(line);\n        }\n      } else {\n        logFn(msg);\n      }\n    };\n\n    const { INTERNAL_CALLSITES_REGEX } = await import('@expo/metro-config');\n\n    const logStackTrace = async (\n      chunk: LogRecord,\n      logFn: (...args: any[]) => void,\n      nestedLogFn: (...args: any[]) => void\n    ) => {\n      let traceInfo;\n      try {\n        traceInfo = JSON.parse(chunk.msg);\n      } catch {\n        return logFn(chunk.msg);\n      }\n\n      const { message, stack } = traceInfo;\n      Log.addNewLineIfNone();\n      logFn(chalk.bold(message));\n\n      const isLibraryFrame = (line: string) => {\n        return line.startsWith('node_modules');\n      };\n\n      const stackFrames: string[] = stack.split('\\n').filter((line: string) => line);\n      const lastAppCodeFrameIndex = findLastIndex(stackFrames, (line: string) => {\n        return !isLibraryFrame(line);\n      });\n      let lastFrameIndexToLog = Math.min(\n        stackFrames.length - 1,\n        lastAppCodeFrameIndex + 2 // show max two more frames after last app code frame\n      );\n      let unloggedFrames = stackFrames.length - lastFrameIndexToLog;\n\n      // If we're only going to exclude one frame, just log them all\n      if (unloggedFrames === 1) {\n        lastFrameIndexToLog = stackFrames.length - 1;\n        unloggedFrames = 0;\n      }\n\n      for (let i = 0; i <= lastFrameIndexToLog; i++) {\n        const line = stackFrames[i];\n\n        if (!line) {\n          continue;\n        }\n\n        let isCollapsed = false;\n        const fileNameOrUrl = matchFileNameOrURLFromStackTrace(line);\n        if (fileNameOrUrl) {\n          // Use the same regex we use in Metro config to filter out traces:\n          isCollapsed = INTERNAL_CALLSITES_REGEX.test(fileNameOrUrl);\n\n          // Unless the user is in debug mode, skip printing the collapsed files.\n          if (!Log.isDebug && isCollapsed) {\n            continue;\n          }\n        }\n\n        // If a file is collapsed, print it with dim styling.\n        const style = isCollapsed ? chalk.dim : (message: string) => message;\n        // Use the `at` prefix to match Node.js\n        nestedLogFn(style('at ' + line));\n      }\n\n      if (unloggedFrames > 0) {\n        nestedLogFn(`- ... ${unloggedFrames} more stack frames from framework internals`);\n      }\n\n      Log.printNewLineBeforeNextLog();\n    };\n\n    const logWithLevel = (chunk: LogRecord) => {\n      if (!chunk.msg) {\n        return;\n      }\n      if (chunk.level <= bunyan.INFO) {\n        if (chunk.includesStack) {\n          logStackTrace(chunk, Log.log, Log.nested);\n        } else {\n          logLines(chunk.msg, Log.log);\n        }\n      } else if (chunk.level === bunyan.WARN) {\n        if (chunk.includesStack) {\n          logStackTrace(chunk, Log.warn, Log.nestedWarn);\n        } else {\n          logLines(chunk.msg, Log.warn);\n        }\n      } else {\n        if (chunk.includesStack) {\n          logStackTrace(chunk, Log.error, Log.nestedError);\n        } else {\n          logLines(chunk.msg, Log.error);\n        }\n      }\n    };\n\n    let bar: ProgressBar | null;\n    // eslint-disable-next-line no-new\n    new PackagerLogsStream({\n      projectRoot,\n      onStartBuildBundle({ bundleDetails }) {\n        // TODO: Unify with commands/utils/progress.ts\n        const platform = PackagerLogsStream.getPlatformTagForBuildDetails(bundleDetails);\n        bar = new ProgressBar(`${platform}Bundling JavaScript [:bar] :percent`, {\n          width: 64,\n          total: 100,\n          clear: true,\n          complete: '=',\n          incomplete: ' ',\n        });\n\n        Log.setBundleProgressBar(bar);\n      },\n      onProgressBuildBundle({ progress }) {\n        if (!bar || bar.complete) return;\n        const ticks = progress - bar.curr;\n        ticks > 0 && bar.tick(ticks);\n      },\n      onFinishBuildBundle({ error, start, end, bundleDetails }) {\n        if (bar && !bar.complete) {\n          bar.tick(100 - bar.curr);\n        }\n\n        if (bar) {\n          Log.setBundleProgressBar(null);\n          bar.terminate();\n          bar = null;\n\n          const platform = PackagerLogsStream.getPlatformTagForBuildDetails(bundleDetails);\n          const totalBuildTimeMs = end.getTime() - start.getTime();\n          const durationSuffix = chalk.gray(` ${totalBuildTimeMs}ms`);\n          if (error) {\n            Log.log(chalk.red(`${platform}Bundling failed` + durationSuffix));\n          } else {\n            Log.log(chalk.green(`${platform}Bundling complete` + durationSuffix));\n            StatusEventEmitter.emit('bundleBuildFinish', { totalBuildTimeMs });\n          }\n        }\n      },\n      updateLogs: (updater: LogUpdater) => {\n        const newLogChunks = updater([]);\n        newLogChunks.forEach((newLogChunk: LogRecord) => {\n          if (newLogChunk.issueId && newLogChunk.issueCleared) {\n            return;\n          }\n          logWithLevel(newLogChunk);\n        });\n      },\n    });\n\n    // needed for validation logging to function\n    ProjectUtils.attachLoggerStream(projectRoot, {\n      stream: {\n        write: (chunk: LogRecord) => {\n          if (chunk.tag === 'device') {\n            logWithLevel(chunk);\n            StatusEventEmitter.emit('deviceLogReceive', {\n              deviceId: chunk.deviceId,\n              deviceName: chunk.deviceName,\n            });\n          }\n        },\n      },\n      type: 'raw',\n    });\n\n    // The existing CLI modules only pass one argument to this function, so skipProjectValidation\n    // will be undefined in most cases. we can explicitly pass a truthy value here to avoid\n    // validation (eg for init)\n    //\n    // If the packager/manifest server is running and healthy, there is no need\n    // to rerun Doctor because the directory was already checked previously\n    // This is relevant for command such as `send`\n    if (\n      options.checkConfig &&\n      (await ProjectSettings.getCurrentStatusAsync(projectRoot)) !== 'running'\n    ) {\n      const spinner = ora('Making sure project is set up correctly...').start();\n      Log.setSpinner(spinner);\n      // validate that this is a good projectDir before we try anything else\n\n      const { Doctor } = await import('xdl');\n      const status = await Doctor.validateWithoutNetworkAsync(projectRoot, {\n        skipSDKVersionRequirement: options.skipSDKVersionRequirement,\n      });\n      if (status === Doctor.FATAL) {\n        throw new Error(`There is an error with your project. See above logs for information.`);\n      }\n      spinner.stop();\n      Log.setSpinner(null);\n    }\n\n    // the existing CLI modules only pass one argument to this function, so skipProjectValidation\n    // will be undefined in most cases. we can explicitly pass a truthy value here to avoid validation (eg for init)\n\n    return asyncFn(projectRoot, ...args);\n  });\n};\n\nexport async function bootstrapAnalyticsAsync(): Promise<void> {\n  Analytics.initializeClient(\n    '1wHTzmVgmZvNjCalKL45chlc2VN',\n    'https://cdp.expo.dev',\n    packageJSON.version\n  );\n\n  UnifiedAnalytics.initializeClient(\n    '1wabJGd5IiuF9Q8SGlcI90v8WTs',\n    'https://cdp.expo.dev',\n    packageJSON.version\n  );\n\n  const userData = await profileMethod(\n    UserManager.getCachedUserDataAsync,\n    'getCachedUserDataAsync'\n  )();\n\n  if (!userData?.userId) return;\n\n  UnifiedAnalytics.identifyUser(userData.userId, {\n    userId: userData.userId,\n    currentConnection: userData?.currentConnection,\n    username: userData?.username,\n  });\n}\n\nexport function trackUsage(commands: Command[] = []) {\n  const input = process.argv[2];\n  const ExpoCommand = (cmd: Command): boolean =>\n    (cmd._name === input || cmd._alias === input) && input !== undefined;\n  const subCommand = commands.find(ExpoCommand)?._name;\n\n  if (!subCommand) return; // only track valid expo commands\n\n  UnifiedAnalytics.logEvent('action', {\n    action: `expo ${subCommand}`,\n    source: 'expo cli',\n    source_version: UnifiedAnalytics.version,\n  });\n}\n\nasync function runAsync(programName: string) {\n  try {\n    _registerLogs();\n\n    if (Env.shouldEnableAnalytics()) {\n      await bootstrapAnalyticsAsync();\n    }\n\n    UserManager.setInteractiveAuthenticationCallback(loginOrRegisterAsync);\n\n    if (process.env.SERVER_URL) {\n      let serverUrl = process.env.SERVER_URL;\n      if (!serverUrl.startsWith('http')) {\n        serverUrl = `http://${serverUrl}`;\n      }\n      const parsedUrl = url.parse(serverUrl);\n      const port = parseInt(parsedUrl.port || '', 10);\n      if (parsedUrl.hostname && port) {\n        Config.api.host = parsedUrl.hostname;\n        Config.api.port = port;\n      } else {\n        throw new Error('Environment variable SERVER_URL is not a valid url');\n      }\n    }\n\n    // Setup our commander instance\n    program.name(programName);\n    program\n      .version(packageJSON.version)\n      .option('--non-interactive', 'Fail, if an interactive prompt would be required to continue.');\n\n    // Load each module found in ./commands by 'registering' it with our commander instance\n    profileMethod(registerCommands)(program);\n\n    trackUsage(program.commands); // must be after register commands\n\n    program.on('command:detach', () => {\n      Log.warn('To eject your project to ExpoKit (previously \"detach\"), use `expo eject`.');\n      process.exit(0);\n    });\n\n    program.on('command:diagnostics', () => {\n      Log.warn('The `expo diagnostics` command is deprecated, use `npx expo-env-info` instead.');\n      process.exit(0);\n    });\n\n    program.on('command:*', subCommand => {\n      let msg = `\"${subCommand}\" is not an expo command. See \"expo --help\" for the full list of commands.`;\n      const availableCommands = program.commands.map((cmd: Command) => cmd._name);\n      // finding the best match whose edit distance is less than 40% of their length.\n      const suggestion = availableCommands.find(\n        (commandName: string) => leven(commandName, subCommand[0]) < commandName.length * 0.4\n      );\n      if (suggestion) {\n        msg = `\"${subCommand}\" is not an expo command -- did you mean ${suggestion}?\\n See \"expo --help\" for the full list of commands.`;\n      }\n      Log.warn(msg);\n    });\n\n    if (typeof program.nonInteractive === 'undefined') {\n      // Commander doesn't initialize boolean args with default values.\n      program.nonInteractive = !process.stdin.isTTY;\n    }\n\n    program.parse(process.argv);\n\n    // Show help when no sub-command specified\n    if (program.args.length === 0) {\n      program.help();\n    }\n  } catch (e: any) {\n    Log.error(e);\n    throw e;\n  }\n}\n\nasync function checkCliVersionAsync() {\n  // Skip checking for latest version on EAS Build\n  if (getenv.boolish('EAS_BUILD', false)) {\n    return;\n  }\n\n  Log.nestedWarn(\n    boxen(\n      chalk.red(\n        `${chalk.bold(\n          'The global expo-cli package has been deprecated.'\n        )}\\n\\nThe new Expo CLI is now bundled in your project in the ${chalk.bold(\n          'expo'\n        )} package.\\nLearn more: https://blog.expo.dev/the-new-expo-cli-f4250d8e3421.\\n\\nTo use the local CLI instead (recommended in SDK 46 and higher), run:\\n\\u203A ${chalk.bold(\n          `npx expo <command>`\n        )}`\n      ),\n      { borderColor: 'red', padding: 1 }\n    )\n  );\n}\n\nfunction _registerLogs() {\n  const stream: bunyan.Stream = {\n    level: Log.isDebug ? 'debug' : 'info',\n    stream: {\n      write: (chunk: any) => {\n        if (chunk.code) {\n          switch (chunk.code) {\n            case LoadingEvent.START_PROGRESS_BAR: {\n              const bar = new ProgressBar(chunk.msg, {\n                width: 64,\n                total: 100,\n                clear: true,\n                complete: '=',\n                incomplete: ' ',\n              });\n              Log.setBundleProgressBar(bar);\n              return;\n            }\n            case LoadingEvent.TICK_PROGRESS_BAR: {\n              const bar = Log.getProgress();\n              if (bar) {\n                bar.tick(1, chunk.msg);\n              }\n              return;\n            }\n            case LoadingEvent.STOP_PROGRESS_BAR: {\n              const bar = Log.getProgress();\n              if (bar) {\n                Log.setBundleProgressBar(null);\n                bar.terminate();\n              }\n              return;\n            }\n            case LoadingEvent.START_LOADING:\n              logNewSection(chunk.msg || '');\n              return;\n            case LoadingEvent.STOP_LOADING: {\n              const spinner = Log.getSpinner();\n              if (spinner) {\n                spinner.stop();\n              }\n              return;\n            }\n          }\n        }\n\n        if (chunk.level === bunyan.INFO) {\n          Log.log(chunk.msg);\n        } else if (chunk.level === bunyan.WARN) {\n          Log.warn(chunk.msg);\n        } else if (chunk.level === bunyan.DEBUG) {\n          Log.debug(chunk.msg);\n        } else if (chunk.level >= bunyan.ERROR) {\n          Log.error(chunk.msg);\n        }\n      },\n    },\n    type: 'raw',\n  };\n\n  Logger.notifications.addStream(stream);\n  Logger.global.addStream(stream);\n}\n\nasync function writePathAsync() {\n  const subCommand = process.argv[2];\n  if (subCommand === 'prepare-detached-build') {\n    // This is being run from Android Studio or Xcode. Don't want to write PATH in this case.\n    return;\n  }\n\n  await Binaries.writePathToUserSettingsAsync();\n}\n\n// This is the entry point of the CLI\nexport function run(programName: string) {\n  (async function () {\n    await Promise.all([writePathAsync(), runAsync(programName)]);\n  })().catch(e => {\n    Log.error('Uncaught Error', e);\n    process.exit(1);\n  });\n}\n"],"mappings":"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"}