{"version":3,"file":"handleErrors.js","names":["_assert","data","require","_chalk","_interopRequireDefault","_CommandError","_log","obj","__esModule","default","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","_interopRequireWildcard","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","handleErrorsAsync","err","command","AbortCommandError","SilentError","isCommandError","isPluginError","AssertionError","Log","error","message","_isApiError","isXDLError","isConfigError","isJsonFileError","isPackageManagerError","code","addNewLineIfNone","formatStackTrace","Promise","resolve","then","stacktrace","stack","chalk","gray"],"sources":["../../src/utils/handleErrors.ts"],"sourcesContent":["import { AssertionError } from 'assert';\nimport chalk from 'chalk';\n\nimport { AbortCommandError, SilentError } from '../CommandError';\nimport Log from '../log';\n\nexport async function handleErrorsAsync(err: any, { command = '[unknown]' }: { command?: string }) {\n  // TODO: Find better ways to consolidate error messages\n  if (err instanceof AbortCommandError || err instanceof SilentError) {\n    // Do nothing when a prompt is cancelled or the error is logged in a pretty way.\n  } else if (err.isCommandError || err.isPluginError || err instanceof AssertionError) {\n    Log.error(err.message);\n  } else if (err._isApiError) {\n    Log.error(err.message);\n  } else if (err.isXDLError || err.isConfigError) {\n    Log.error(err.message);\n  } else if (err.isJsonFileError || err.isPackageManagerError) {\n    if (err.code === 'EJSONEMPTY') {\n      // Empty JSON is an easy bug to debug. Often this is thrown for package.json or app.json being empty.\n      Log.error(err.message);\n    } else {\n      Log.addNewLineIfNone();\n      Log.error(err.message);\n      const { formatStackTrace } = await import('./formatStackTrace');\n      const stacktrace = formatStackTrace(err.stack, command);\n      Log.error(chalk.gray(stacktrace));\n    }\n  } else {\n    Log.error(err.message);\n    Log.error(chalk.gray(err.stack));\n  }\n\n  //   process.exit(1);\n}\n"],"mappings":"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"}