{"version":3,"file":"validateKeystore.js","names":["_spawnAsync","data","_interopRequireDefault","require","_commandExists","_tempy","_terminalLink","_log","obj","__esModule","default","validateKeystoreAsync","keystore","keystoreBase64","keystorePassword","keyAlias","commandExists","e","Log","warn","terminalLink","temporary","write","task","Buffer","from","keystorePath","spawnAsync","Error","stdout","message"],"sources":["../../../src/credentials/utils/validateKeystore.ts"],"sourcesContent":["import spawnAsync from '@expo/spawn-async';\nimport commandExists from 'command-exists';\nimport temporary from 'tempy';\nimport terminalLink from 'terminal-link';\n\nimport Log from '../../log';\n\nexport default async function validateKeystoreAsync({\n  keystore: keystoreBase64,\n  keystorePassword,\n  keyAlias,\n}: {\n  keystore: string;\n  keystorePassword: string;\n  keyAlias: string;\n}) {\n  try {\n    await commandExists('keytool');\n  } catch (e: any) {\n    Log.warn(\n      `Couldn't validate the provided Android keystore because the 'keytool' command is not available. Make sure that you have a Java Development Kit installed. See ${terminalLink(\n        'https://openjdk.java.net',\n        'https://openjdk.java.net'\n      )} to install OpenJDK.`\n    );\n    return;\n  }\n\n  try {\n    await temporary.write.task(Buffer.from(keystoreBase64, 'base64'), async keystorePath => {\n      await spawnAsync('keytool', [\n        '-list',\n        '-keystore',\n        keystorePath,\n        '-storepass',\n        keystorePassword,\n        '-alias',\n        keyAlias,\n      ]);\n    });\n  } catch (e: any) {\n    throw new Error(\n      `An error occurred when validating the Android keystore: ${\n        e.stdout || e.message\n      }\\nMake sure that you provided correct credentials in 'credentials.json' and the path provided under 'keystorePath' points to a valid keystore file.`\n    );\n  }\n}\n"],"mappings":";;;;;;AAAA,SAAAA,YAAA;EAAA,MAAAC,IAAA,GAAAC,sBAAA,CAAAC,OAAA;EAAAH,WAAA,YAAAA,CAAA;IAAA,OAAAC,IAAA;EAAA;EAAA,OAAAA,IAAA;AAAA;AACA,SAAAG,eAAA;EAAA,MAAAH,IAAA,GAAAC,sBAAA,CAAAC,OAAA;EAAAC,cAAA,YAAAA,CAAA;IAAA,OAAAH,IAAA;EAAA;EAAA,OAAAA,IAAA;AAAA;AACA,SAAAI,OAAA;EAAA,MAAAJ,IAAA,GAAAC,sBAAA,CAAAC,OAAA;EAAAE,MAAA,YAAAA,CAAA;IAAA,OAAAJ,IAAA;EAAA;EAAA,OAAAA,IAAA;AAAA;AACA,SAAAK,cAAA;EAAA,MAAAL,IAAA,GAAAC,sBAAA,CAAAC,OAAA;EAAAG,aAAA,YAAAA,CAAA;IAAA,OAAAL,IAAA;EAAA;EAAA,OAAAA,IAAA;AAAA;AAEA,SAAAM,KAAA;EAAA,MAAAN,IAAA,GAAAC,sBAAA,CAAAC,OAAA;EAAAI,IAAA,YAAAA,CAAA;IAAA,OAAAN,IAAA;EAAA;EAAA,OAAAA,IAAA;AAAA;AAA4B,SAAAC,uBAAAM,GAAA,WAAAA,GAAA,IAAAA,GAAA,CAAAC,UAAA,GAAAD,GAAA,KAAAE,OAAA,EAAAF,GAAA;AAEb,eAAeG,qBAAqBA,CAAC;EAClDC,QAAQ,EAAEC,cAAc;EACxBC,gBAAgB;EAChBC;AAKF,CAAC,EAAE;EACD,IAAI;IACF,MAAM,IAAAC,wBAAa,EAAC,SAAS,CAAC;EAChC,CAAC,CAAC,OAAOC,CAAM,EAAE;IACfC,cAAG,CAACC,IAAI,CACL,iKAAgK,IAAAC,uBAAY,EAC3K,0BAA0B,EAC1B,0BACF,CAAE,sBACJ,CAAC;IACD;EACF;EAEA,IAAI;IACF,MAAMC,gBAAS,CAACC,KAAK,CAACC,IAAI,CAACC,MAAM,CAACC,IAAI,CAACZ,cAAc,EAAE,QAAQ,CAAC,EAAE,MAAMa,YAAY,IAAI;MACtF,MAAM,IAAAC,qBAAU,EAAC,SAAS,EAAE,CAC1B,OAAO,EACP,WAAW,EACXD,YAAY,EACZ,YAAY,EACZZ,gBAAgB,EAChB,QAAQ,EACRC,QAAQ,CACT,CAAC;IACJ,CAAC,CAAC;EACJ,CAAC,CAAC,OAAOE,CAAM,EAAE;IACf,MAAM,IAAIW,KAAK,CACZ,2DACCX,CAAC,CAACY,MAAM,IAAIZ,CAAC,CAACa,OACf,qJACH,CAAC;EACH;AACF"}