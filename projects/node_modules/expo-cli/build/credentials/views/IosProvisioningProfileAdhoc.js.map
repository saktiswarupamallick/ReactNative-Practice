{"version":3,"file":"IosProvisioningProfileAdhoc.js","names":["_chalk","data","_interopRequireDefault","require","_provisioningProfileAdhoc","_log","obj","__esModule","default","_defineProperty","key","value","_toPropertyKey","Object","defineProperty","enumerable","configurable","writable","arg","_toPrimitive","String","input","hint","prim","Symbol","toPrimitive","undefined","res","call","TypeError","Number","CreateOrReuseProvisioningProfileAdhoc","constructor","app","options","distCertSerialNumber","udids","assignProvisioningProfile","ctx","provisioningProfile","ios","updateProvisioningProfile","Log","log","chalk","green","provisioningProfileId","accountName","projectName","bundleIdentifier","createOrReuse","ensureAppleCtx","ppManager","ProvisioningProfileAdhocManager","appleCtx","open","user","Error","exports"],"sources":["../../../src/credentials/views/IosProvisioningProfileAdhoc.ts"],"sourcesContent":["import chalk from 'chalk';\n\nimport { ProvisioningProfile } from '../../appleApi';\nimport { ProvisioningProfileAdhocManager } from '../../appleApi/provisioningProfileAdhoc';\nimport Log from '../../log';\nimport { AppLookupParams } from '../api/IosApi';\nimport { Context, IView } from '../context';\n\nexport type ProvisioningProfileAdhocOptions = {\n  distCertSerialNumber: string;\n  udids: string[];\n};\n\nexport class CreateOrReuseProvisioningProfileAdhoc implements IView {\n  private distCertSerialNumber: string;\n  private udids: string[];\n\n  constructor(private app: AppLookupParams, options: ProvisioningProfileAdhocOptions) {\n    const { distCertSerialNumber, udids } = options;\n    this.distCertSerialNumber = distCertSerialNumber;\n    this.udids = udids;\n  }\n\n  async assignProvisioningProfile(ctx: Context, provisioningProfile: ProvisioningProfile) {\n    await ctx.ios.updateProvisioningProfile(this.app, provisioningProfile);\n    Log.log(\n      chalk.green(\n        `Successfully assigned Provisioning Profile id: ${provisioningProfile.provisioningProfileId} to @${this.app.accountName}/${this.app.projectName} (${this.app.bundleIdentifier})`\n      )\n    );\n  }\n\n  async createOrReuse(ctx: Context): Promise<ProvisioningProfile> {\n    await ctx.ensureAppleCtx();\n    const ppManager = new ProvisioningProfileAdhocManager(ctx.appleCtx);\n    return await ppManager.createOrReuse(\n      this.udids,\n      this.app.bundleIdentifier,\n      this.distCertSerialNumber\n    );\n  }\n\n  async open(ctx: Context): Promise<IView | null> {\n    if (!ctx.user) {\n      throw new Error(`This workflow requires you to be logged in.`);\n    }\n\n    const provisioningProfile = await this.createOrReuse(ctx);\n    await this.assignProvisioningProfile(ctx, provisioningProfile);\n    return null;\n  }\n}\n"],"mappings":"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"}