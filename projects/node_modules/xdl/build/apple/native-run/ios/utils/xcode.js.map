{"version":3,"file":"xcode.js","names":["_fs","data","_interopRequireDefault","require","_process","obj","__esModule","default","getXCodePath","stdout","execFile","encoding","trim","Error","getDeveloperDiskImagePath","version","xCodePath","versionDirs","fs","promises","readdir","versionPrefix","match","dir","includes"],"sources":["../../../../../src/apple/native-run/ios/utils/xcode.ts"],"sourcesContent":["/**\n * Copyright (c) 2021 Expo, Inc.\n * Copyright (c) 2018 Drifty Co.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport fs from 'fs';\n\nimport { execFile } from '../../utils/process';\n\nexport async function getXCodePath() {\n  try {\n    const { stdout } = await execFile('xcode-select', ['-p'], {\n      encoding: 'utf8',\n    });\n    if (stdout) {\n      return stdout.trim();\n    }\n  } catch {\n    // ignore\n  }\n  throw new Error('Unable to get Xcode location. Is Xcode installed?');\n}\n\nexport async function getDeveloperDiskImagePath(version: string) {\n  const xCodePath = await getXCodePath();\n  const versionDirs = await fs.promises.readdir(\n    `${xCodePath}/Platforms/iPhoneOS.platform/DeviceSupport/`\n  );\n  const versionPrefix = version.match(/\\d+\\.\\d+/);\n  if (versionPrefix === null) {\n    throw new Error(`Invalid iOS version: ${version}`);\n  }\n  // Can look like \"11.2 (15C107)\"\n  for (const dir of versionDirs) {\n    if (dir.includes(versionPrefix[0])) {\n      return `${xCodePath}/Platforms/iPhoneOS.platform/DeviceSupport/${dir}/DeveloperDiskImage.dmg`;\n    }\n  }\n  throw new Error(\n    `Unable to find Developer Disk Image path for SDK ${version}. Do you have the right version of Xcode?`\n  );\n}\n"],"mappings":";;;;;;;AAOA,SAAAA,IAAA;EAAA,MAAAC,IAAA,GAAAC,sBAAA,CAAAC,OAAA;EAAAH,GAAA,YAAAA,CAAA;IAAA,OAAAC,IAAA;EAAA;EAAA,OAAAA,IAAA;AAAA;AAEA,SAAAG,SAAA;EAAA,MAAAH,IAAA,GAAAE,OAAA;EAAAC,QAAA,YAAAA,CAAA;IAAA,OAAAH,IAAA;EAAA;EAAA,OAAAA,IAAA;AAAA;AAA+C,SAAAC,uBAAAG,GAAA,WAAAA,GAAA,IAAAA,GAAA,CAAAC,UAAA,GAAAD,GAAA,KAAAE,OAAA,EAAAF,GAAA;AAT/C;AACA;AACA;AACA;AACA;AACA;AACA;;AAKO,eAAeG,YAAYA,CAAA,EAAG;EACnC,IAAI;IACF,MAAM;MAAEC;IAAO,CAAC,GAAG,MAAM,IAAAC,mBAAQ,EAAC,cAAc,EAAE,CAAC,IAAI,CAAC,EAAE;MACxDC,QAAQ,EAAE;IACZ,CAAC,CAAC;IACF,IAAIF,MAAM,EAAE;MACV,OAAOA,MAAM,CAACG,IAAI,CAAC,CAAC;IACtB;EACF,CAAC,CAAC,MAAM;IACN;EAAA;EAEF,MAAM,IAAIC,KAAK,CAAC,mDAAmD,CAAC;AACtE;AAEO,eAAeC,yBAAyBA,CAACC,OAAe,EAAE;EAC/D,MAAMC,SAAS,GAAG,MAAMR,YAAY,CAAC,CAAC;EACtC,MAAMS,WAAW,GAAG,MAAMC,aAAE,CAACC,QAAQ,CAACC,OAAO,CAC1C,GAAEJ,SAAU,6CACf,CAAC;EACD,MAAMK,aAAa,GAAGN,OAAO,CAACO,KAAK,CAAC,UAAU,CAAC;EAC/C,IAAID,aAAa,KAAK,IAAI,EAAE;IAC1B,MAAM,IAAIR,KAAK,CAAE,wBAAuBE,OAAQ,EAAC,CAAC;EACpD;EACA;EACA,KAAK,MAAMQ,GAAG,IAAIN,WAAW,EAAE;IAC7B,IAAIM,GAAG,CAACC,QAAQ,CAACH,aAAa,CAAC,CAAC,CAAC,CAAC,EAAE;MAClC,OAAQ,GAAEL,SAAU,8CAA6CO,GAAI,yBAAwB;IAC/F;EACF;EACA,MAAM,IAAIV,KAAK,CACZ,oDAAmDE,OAAQ,2CAC9D,CAAC;AACH"}